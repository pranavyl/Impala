# Simple query to introduce projection dependencies. Shows resolution
# through inline views, unions, and materialization points.
select * from (
  select tinyint_col + int_col x from functional.alltypes
  union all
  select sum(bigint_col) y from (select bigint_col from functional.alltypes) v1) v2
---- LINEAGE
{
    "queryText":"select * from (\n  select tinyint_col + int_col x from functional.alltypes\n  union all\n  select sum(bigint_col) y from (select bigint_col from functional.alltypes) v1) v2",
    "queryId":"0:0",
    "hash":"1a88e455569d619b268157867d97489d",
    "user":"dummy_user",
    "timestamp":1687551743,
    "edges":[
        {
            "sources":[
                1,
                2,
                3
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"x"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Simple query to introduce predicate dependencies. Shows conjuncts in WHERE, ON, and
# HAVING clause, as well dependencies introduced by GROUP BY and ORDER BY clauses and
# analytic functions.
select sum(a.tinyint_col) over (partition by a.smallint_col order by a.id),
  count(b.string_col), b.timestamp_col
from functional.alltypes a join functional.alltypessmall b on (a.id = b.id)
where a.year = 2010 and b.float_col > 0
group by a.tinyint_col, a.smallint_col, a.id, b.string_col, b.timestamp_col, b.bigint_col
having count(a.int_col) > 10
order by b.bigint_col limit 10
---- LINEAGE
{
    "queryText":"select sum(a.tinyint_col) over (partition by a.smallint_col order by a.id),\n  count(b.string_col), b.timestamp_col\nfrom functional.alltypes a join functional.alltypessmall b on (a.id = b.id)\nwhere a.year = 2010 and b.float_col > 0\ngroup by a.tinyint_col, a.smallint_col, a.id, b.string_col, b.timestamp_col, b.bigint_col\nhaving count(a.int_col) > 10\norder by b.bigint_col limit 10",
    "queryId":"0:0",
    "hash":"ea11605d73c3e77c40d2905de9a1f008",
    "user":"dummy_user",
    "timestamp":1687551744,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                2,
                3
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                2,
                3,
                5,
                7,
                8,
                9,
                10,
                11,
                12
            ],
            "targets":[
                0,
                4,
                6
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"sum(a.tinyint_col) OVER(...)"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"count(b.string_col)"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col"
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
# CTAS queries
create table lineage_test_tbl as select int_col, tinyint_col from functional.alltypes
---- LINEAGE
{
    "queryText":"create table lineage_test_tbl as select int_col, tinyint_col from functional.alltypes",
    "queryId":"0:0",
    "hash":"2f673a20092048a5035f4a01edd612fd",
    "user":"dummy_user",
    "timestamp":1687551744,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tbl",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tbl",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
create table lineage_test_tbl as
select distinct a.int_col, a.string_col from functional.alltypes a
inner join functional.alltypessmall b on (a.id = b.id)
where a.year = 2009 and b.month = 2
---- LINEAGE
{
    "queryText":"create table lineage_test_tbl as\nselect distinct a.int_col, a.string_col from functional.alltypes a\ninner join functional.alltypessmall b on (a.id = b.id)\nwhere a.year = 2009 and b.month = 2",
    "queryId":"0:0",
    "hash":"2c547ba840dfc511483fd1a5909da15f",
    "user":"dummy_user",
    "timestamp":1687551744,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                4,
                5,
                6,
                7
            ],
            "targets":[
                0,
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tbl",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tbl",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
create table lineage_test_tbl as
select * from
  (select * from
     (select int_col from functional.alltypestiny limit 1) v1 ) v2
---- LINEAGE
{
    "queryText":"create table lineage_test_tbl as\nselect * from\n  (select * from\n     (select int_col from functional.alltypestiny limit 1) v1 ) v2",
    "queryId":"0:0",
    "hash":"d34ab281d4fcf088efe7b558a5786a00",
    "user":"dummy_user",
    "timestamp":1687551744,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tbl",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        }
    ]
}
====
# CTAS from HBase table
create table lineage_test_tblm as select * from functional_hbase.alltypes limit 5
---- LINEAGE
{
    "queryText":"create table lineage_test_tblm as select * from functional_hbase.alltypes limit 5",
    "queryId":"0:0",
    "hash":"b69259e85dac890c7df82ca94dcf8c54",
    "user":"dummy_user",
    "timestamp":1687551744,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                13
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                15
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                17
            ],
            "targets":[
                16
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                19
            ],
            "targets":[
                18
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                21
            ],
            "targets":[
                20
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                23
            ],
            "targets":[
                22
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                25
            ],
            "targets":[
                24
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.id",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.bigint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.bool_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.date_string_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.double_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.float_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.int_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"month",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.month",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":17,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.smallint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":18,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":19,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.string_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":20,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":21,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.timestamp_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":22,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":23,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":24,
            "vertexType":"COLUMN",
            "vertexId":"year",
            "metadata":{
                "tableType":"hive",
                "tableName":"default.lineage_test_tblm",
                "tableCreateTime":-1
            }
        },
        {
            "id":25,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypes.year",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        }
    ]
}
====
# Insert into an HBase table
insert into
functional_hbase.alltypes
  values (1, 1, true, "1999-12-01", 2.0, 1.0, 1, 12, 2, "abs",
  cast(now() as timestamp), 1, 1999)
---- LINEAGE
{
    "queryText":"insert into\nfunctional_hbase.alltypes\n  values (1, 1, true, \"1999-12-01\", 2.0, 1.0, 1, 12, 2, \"abs\",\n  cast(now() as timestamp), 1, 1999)",
    "queryId":"0:0",
    "hash":"7eacea08a1e442fae1edb6734cd15551",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                1
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                3
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                5
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"month",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"year",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypes",
                "tableCreateTime":1687531612
            }
        }
    ]
}
====
insert into table functional.alltypesnopart (id, bool_col, timestamp_col)
select id, bool_col, timestamp_col
from functional.alltypes
---- LINEAGE
{
    "queryText":"insert into table functional.alltypesnopart (id, bool_col, timestamp_col)\nselect id, bool_col, timestamp_col\nfrom functional.alltypes",
    "queryId":"0:0",
    "hash":"24d103f36450208bfb8cccfa2db687c4",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                5
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                13
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesnopart",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
insert into table functional.alltypessmall (smallint_col, int_col)
partition (year=2009, month=04)
select smallint_col, int_col
from functional.alltypes
where year=2009 and month=05
---- LINEAGE
{
    "queryText":"insert into table functional.alltypessmall (smallint_col, int_col)\npartition (year=2009, month=04)\nselect smallint_col, int_col\nfrom functional.alltypes\nwhere year=2009 and month=05",
    "queryId":"0:0",
    "hash":"1d7f2ed12efeb2876353734d7f1fca33",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                1
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                3
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                5
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                8
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                13
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                15,
                16
            ],
            "targets":[
                0,
                1,
                2,
                3,
                4,
                5,
                7,
                9,
                10,
                11,
                12,
                13,
                14
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
insert into table functional.alltypessmall (id, string_col, int_col)
partition (year, month)
select id, string_col, int_col, year, month
from functional_seq_snap.alltypes
where year=2009 and month>10
---- LINEAGE
{
    "queryText":"insert into table functional.alltypessmall (id, string_col, int_col)\npartition (year, month)\nselect id, string_col, int_col, year, month\nfrom functional_seq_snap.alltypes\nwhere year=2009 and month>10",
    "queryId":"0:0",
    "hash":"adbda5f55e1de85c20b63ef02baa49b1",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                10
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                13
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                16
            ],
            "targets":[
                15
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                17
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                0,
                2,
                4,
                6,
                7,
                8,
                9,
                11,
                12,
                13,
                14,
                15,
                17
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_seq_snap.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional_seq_snap.alltypes",
                "tableCreateTime":1687531272
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_seq_snap.alltypes.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional_seq_snap.alltypes",
                "tableCreateTime":1687531272
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional_seq_snap.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional_seq_snap.alltypes",
                "tableCreateTime":1687531272
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional_seq_snap.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional_seq_snap.alltypes",
                "tableCreateTime":1687531272
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"functional_seq_snap.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional_seq_snap.alltypes",
                "tableCreateTime":1687531272
            }
        },
        {
            "id":17,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
insert into table functional.alltypessmall
partition (year=2009, month)
select min(id), min(bool_col), min(tinyint_col), min(smallint_col), min(int_col),
min(bigint_col), min(float_col), min(double_col), min(date_string_col), min(string_col),
min(timestamp_col), month
from functional.alltypes
where year=2009 and month>10
group by month
having min(id) > 10
---- LINEAGE
{
    "queryText":"insert into table functional.alltypessmall\npartition (year=2009, month)\nselect min(id), min(bool_col), min(tinyint_col), min(smallint_col), min(int_col),\nmin(bigint_col), min(float_col), min(double_col), min(date_string_col), min(string_col),\nmin(timestamp_col), month\nfrom functional.alltypes\nwhere year=2009 and month>10\ngroup by month\nhaving min(id) > 10",
    "queryId":"0:0",
    "hash":"7059dbbaa22bdf0c2d4c5b08baf11ef2",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                2
            ],
            "targets":[
                1
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                4
            ],
            "targets":[
                3
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                5
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                8
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                10
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                12
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                14
            ],
            "targets":[
                13
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                16
            ],
            "targets":[
                15
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                18
            ],
            "targets":[
                17
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                20
            ],
            "targets":[
                19
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                22
            ],
            "targets":[
                21
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                24
            ],
            "targets":[
                23
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                2,
                4,
                25
            ],
            "targets":[
                0,
                1,
                3,
                5,
                7,
                9,
                11,
                13,
                15,
                17,
                19,
                21,
                23
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":17,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":18,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":19,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":20,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":21,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":22,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":23,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":24,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":25,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Select statements with analytic functions
select
max(tinyint_col) over(partition by int_col)
from functional.alltypes
group by int_col, tinyint_col
---- LINEAGE
{
    "queryText":"select\nmax(tinyint_col) over(partition by int_col)\nfrom functional.alltypes\ngroup by int_col, tinyint_col",
    "queryId":"0:0",
    "hash":"4de56e1b4b44d31bf3851fb46deed110",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                2
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"max(tinyint_col) OVER(...)"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
select int_col, rank() over(order by int_col) from functional.alltypesagg
---- LINEAGE
{
    "queryText":"select int_col, rank() over(order by int_col) from functional.alltypesagg",
    "queryId":"0:0",
    "hash":"6c646de10e62d1155b5216ae8589ff6d",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"rank() OVER(...)"
        }
    ]
}
====
select a.tinyint_col, a.int_col, count(a.double_col)
  over(partition by a.tinyint_col order by a.int_col desc rows between 1 preceding and 1 following)
from functional.alltypes a inner join functional.alltypessmall b on a.id = b.id
order by a.tinyint_col, a.int_col
---- LINEAGE
{
    "queryText":"select a.tinyint_col, a.int_col, count(a.double_col)\n  over(partition by a.tinyint_col order by a.int_col desc rows between 1 preceding and 1 following)\nfrom functional.alltypes a inner join functional.alltypessmall b on a.id = b.id\norder by a.tinyint_col, a.int_col",
    "queryId":"0:0",
    "hash":"57958e2fb9f6dd0277f91593b59ed66e",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                4
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                6,
                7
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"int_col"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"count(a.double_col) OVER(...)"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
with v2 as
  (select
   double_col,
   count(int_col) over() a,
   sum(int_col + bigint_col) over(partition by bool_col) b
   from
     (select * from functional.alltypes) v1)
select double_col, a, b, a + b, double_col + a from v2
order by 2, 3, 4
---- LINEAGE
{
    "queryText":"with v2 as\n  (select\n   double_col,\n   count(int_col) over() a,\n   sum(int_col + bigint_col) over(partition by bool_col) b\n   from\n     (select * from functional.alltypes) v1)\nselect double_col, a, b, a + b, double_col + a from v2\norder by 2, 3, 4",
    "queryId":"0:0",
    "hash":"94cd8f86dbdf00a40b9d935bccffcbaa",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3,
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                4
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                3,
                5
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                7
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"double_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"a"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"b"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"a + b"
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"double_col + a"
        }
    ]
}
====
select double_col, a, b, a + b, double_col + a from
  (select
   double_col,
   count(int_col) over() a,
   sum(int_col + bigint_col) over(partition by bool_col) b
   from
     (select * from functional.alltypes) v1) v2
order by 2, 3, 4
---- LINEAGE
{
    "queryText":"select double_col, a, b, a + b, double_col + a from\n  (select\n   double_col,\n   count(int_col) over() a,\n   sum(int_col + bigint_col) over(partition by bool_col) b\n   from\n     (select * from functional.alltypes) v1) v2\norder by 2, 3, 4",
    "queryId":"0:0",
    "hash":"4c67b7dddb64d9f584c1e6bd9e182fc6",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3,
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                4
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                3,
                5
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                7
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"double_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"a"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"b"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"a + b"
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"double_col + a"
        }
    ]
}
====
# Union statements
select a.month, a.year, b.int_col, b.month
from
  (select year, month from functional.alltypes
   union all
   select year, month from functional.alltypes) a
  inner join
  functional.alltypessmall b
  on (a.month = b.month)
where b.month = 1
---- LINEAGE
{
    "queryText":"select a.month, a.year, b.int_col, b.month\nfrom\n  (select year, month from functional.alltypes\n   union all\n   select year, month from functional.alltypes) a\n  inner join\n  functional.alltypessmall b\n  on (a.month = b.month)\nwhere b.month = 1",
    "queryId":"0:0",
    "hash":"6f38ebd361a51366f80a9f889f302424",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                6
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"month"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"year"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"int_col"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
# Select statements with inline views
select t1.int_col, t2.month, t2.int_col + 1
from (
  select int_col, count(*)
  from functional.alltypessmall
  where month = 1
  group by int_col
  having count(*) > 1
  order by count(*) desc limit 5
  ) t1
join functional.alltypes t2 on (t1.int_col = t2.int_col)
where month = 1
---- LINEAGE
{
    "queryText":"select t1.int_col, t2.month, t2.int_col + 1\nfrom (\n  select int_col, count(*)\n  from functional.alltypessmall\n  where month = 1\n  group by int_col\n  having count(*) > 1\n  order by count(*) desc limit 5\n  ) t1\njoin functional.alltypes t2 on (t1.int_col = t2.int_col)\nwhere month = 1",
    "queryId":"0:0",
    "hash":"90ceff377b6984b0c3eb7306c3711b38",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3,
                5,
                6
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"month"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"t2.int_col + 1"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
select x.smallint_col, x.id, x.tinyint_col, c.id, x.int_col, x.float_col, c.string_col
from functional.alltypessmall c
join (
   select a.smallint_col smallint_col, a.tinyint_col tinyint_col, a.day day,
           a.int_col int_col, a.month month, b.float_col float_col, b.id id
   from ( select * from functional.alltypesagg a where month=1 ) a
   join functional.alltypessmall b on (a.smallint_col = b.id)
 ) x on (x.tinyint_col = c.id)
where x.day=1
and x.int_col > 899
and x.float_col > 4.5
and c.string_col < '7'
and x.int_col + x.float_col + cast(c.string_col as float) < 1000
---- LINEAGE
{
    "queryText":"select x.smallint_col, x.id, x.tinyint_col, c.id, x.int_col, x.float_col, c.string_col\nfrom functional.alltypessmall c\njoin (\n   select a.smallint_col smallint_col, a.tinyint_col tinyint_col, a.day day,\n           a.int_col int_col, a.month month, b.float_col float_col, b.id id\n   from ( select * from functional.alltypesagg a where month=1 ) a\n   join functional.alltypessmall b on (a.smallint_col = b.id)\n ) x on (x.tinyint_col = c.id)\nwhere x.day=1\nand x.int_col > 899\nand x.float_col > 4.5\nand c.string_col < '7'\nand x.int_col + x.float_col + cast(c.string_col as float) < 1000",
    "queryId":"0:0",
    "hash":"154323930680f2bff235d4abcf5afa62",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3,
                5,
                7,
                9,
                11,
                12,
                13
            ],
            "targets":[
                0,
                2,
                4,
                6,
                8,
                10
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"id"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"int_col"
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"float_col"
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"string_col"
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.day",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        }
    ]
}
====
select c1, c2, c3
from
  (select c1, c2, c3
   from
     (select int_col c1, sum(float_col) c2, min(float_col) c3
      from functional_hbase.alltypessmall
      group by 1) x
    order by 2,3 desc
    limit 5
) y
---- LINEAGE
{
    "queryText":"select c1, c2, c3\nfrom\n  (select c1, c2, c3\n   from\n     (select int_col c1, sum(float_col) c2, min(float_col) c3\n      from functional_hbase.alltypessmall\n      group by 1) x\n    order by 2,3 desc\n    limit 5\n) y",
    "queryId":"0:0",
    "hash":"412ef8a4c54e66f19a0065c3fecc5c76",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"c1"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypessmall.int_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypessmall",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"c2"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypessmall.float_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypessmall",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"c3"
        }
    ]
}
====
select c1, x2
from (
  select c1, min(c2) x2
  from (
    select c1, c2, c3
    from (
      select int_col c1, tinyint_col c2, min(float_col) c3
      from functional_hbase.alltypessmall
      group by 1, 2
      order by 1,2
      limit 1
    ) x
  ) x2
  group by c1
) y
order by 2,1 desc
limit 0
---- LINEAGE
{
    "queryText":"select c1, x2\nfrom (\n  select c1, min(c2) x2\n  from (\n    select c1, c2, c3\n    from (\n      select int_col c1, tinyint_col c2, min(float_col) c3\n      from functional_hbase.alltypessmall\n      group by 1, 2\n      order by 1,2\n      limit 1\n    ) x\n  ) x2\n  group by c1\n) y\norder by 2,1 desc\nlimit 0",
    "queryId":"0:0",
    "hash":"44626c1f89757d07604a3f054e98d67d",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                0,
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"c1"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypessmall.int_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypessmall",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"x2"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypessmall.tinyint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypessmall",
                "tableCreateTime":1687531613
            }
        }
    ]
}
====
# Views
select int_col, string_col from functional.view_view
---- LINEAGE
{
    "queryText":"select int_col, string_col from functional.view_view",
    "queryId":"0:0",
    "hash":"05d4986bc7d30b32d8780d787af559d9",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"string_col"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
select t.id from (select id from functional.alltypes_view) t
where t.id < 10
---- LINEAGE
{
    "queryText":"select t.id from (select id from functional.alltypes_view) t\nwhere t.id < 10",
    "queryId":"0:0",
    "hash":"0c505dc14adb7f037eea4b3c77c39bff",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Subqueries
select string_col, float_col, bool_col
from functional.alltypes
where id in
  (select id from functional.alltypesagg)
---- LINEAGE
{
    "queryText":"select string_col, float_col, bool_col\nfrom functional.alltypes\nwhere id in\n  (select id from functional.alltypesagg)",
    "queryId":"0:0",
    "hash":"ae4a1b83a50d2ce727117d0387c8e098",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                6,
                7
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"string_col"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"float_col"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"bool_col"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        }
    ]
}
====
select 1
from functional.alltypesagg a
where exists
  (select id, count(int_col) over (partition by bool_col)
   from functional.alltypestiny b
   where a.tinyint_col = b.tinyint_col
   group by id, int_col, bool_col)
and tinyint_col < 10
---- LINEAGE
{
    "queryText":"select 1\nfrom functional.alltypesagg a\nwhere exists\n  (select id, count(int_col) over (partition by bool_col)\n   from functional.alltypestiny b\n   where a.tinyint_col = b.tinyint_col\n   group by id, int_col, bool_col)\nand tinyint_col < 10",
    "queryId":"0:0",
    "hash":"ce3e78ae349dd67613458acb0dac572f",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                2
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"1"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        }
    ]
}
====
select int_col + 1, tinyint_col - 1
from functional.alltypes a
where a.int_col <
  (select max(int_col) from functional.alltypesagg g where g.bool_col = true)
and a.bigint_col > 10
---- LINEAGE
{
    "queryText":"select int_col + 1, tinyint_col - 1\nfrom functional.alltypes a\nwhere a.int_col <\n  (select max(int_col) from functional.alltypesagg g where g.bool_col = true)\nand a.bigint_col > 10",
    "queryId":"0:0",
    "hash":"2301fac73ccbb692c19615733c977c14",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                4,
                5,
                6
            ],
            "targets":[
                0,
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"int_col + 1"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col - 1"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        }
    ]
}
====
# With clause
with t as (select int_col x, bigint_col y from functional.alltypes) select x, y from t
---- LINEAGE
{
    "queryText":"with t as (select int_col x, bigint_col y from functional.alltypes) select x, y from t",
    "queryId":"0:0",
    "hash":"ff421b2c2b249764028350613be74fb8",
    "user":"dummy_user",
    "timestamp":1687551745,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"x"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"y"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
with t1 as (select * from functional.alltypestiny)
insert into functional.alltypesinsert (id, int_col, string_col) partition(year, month)
select id, int_col, string_col, year, month from t1
---- LINEAGE
{
    "queryText":"with t1 as (select * from functional.alltypestiny)\ninsert into functional.alltypesinsert (id, int_col, string_col) partition(year, month)\nselect id, int_col, string_col, year, month from t1",
    "queryId":"0:0",
    "hash":"0fa8fc72001bde1a8745956bccc77820",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                10
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                13
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                16
            ],
            "targets":[
                15
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                17
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":17,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesinsert",
                "tableCreateTime":1687531270
            }
        }
    ]
}
====
# Nested analytic functions
select lead(a) over (partition by b order by c)
from
  (select lead(id) over (partition by int_col order by bigint_col) as a,
   max(id) over (partition by tinyint_col order by int_col) as b,
   min(int_col) over (partition by string_col order by bool_col) as c
   from functional.alltypes) v
---- LINEAGE
{
    "queryText":"select lead(a) over (partition by b order by c)\nfrom\n  (select lead(id) over (partition by int_col order by bigint_col) as a,\n   max(id) over (partition by tinyint_col order by int_col) as b,\n   min(int_col) over (partition by string_col order by bool_col) as c\n   from functional.alltypes) v",
    "queryId":"0:0",
    "hash":"6891082bb252b6fce39d846bf89c497d",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                2,
                3,
                4,
                5,
                6
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"lead(a, 1, NULL) OVER(...)"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Create view statement (IMPALA-4219)
create view test_view_lineage as select id from functional.alltypestiny
---- LINEAGE
{
    "queryText":"create view test_view_lineage as select id from functional.alltypestiny",
    "queryId":"0:0",
    "hash":"fd85383983eafa8a57731e87fba7b7b6",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        }
    ]
}
====
# Create view with nested inline views (IMPALA-4219)
create view test_view_lineage (a, b) as select c1, x2
from (
  select c1, min(c2) x2
  from (
    select c1, c2, c3
    from (
      select int_col c1, tinyint_col c2, min(float_col) c3
      from functional_hbase.alltypessmall
      group by 1, 2
      order by 1,2
      limit 1
    ) x
  ) x2
  group by c1
) y
order by 2,1 desc
limit 0
---- LINEAGE
{
    "queryText":"create view test_view_lineage (a, b) as select c1, x2\nfrom (\n  select c1, min(c2) x2\n  from (\n    select c1, c2, c3\n    from (\n      select int_col c1, tinyint_col c2, min(float_col) c3\n      from functional_hbase.alltypessmall\n      group by 1, 2\n      order by 1,2\n      limit 1\n    ) x\n  ) x2\n  group by c1\n) y\norder by 2,1 desc\nlimit 0",
    "queryId":"0:0",
    "hash":"a3cdac0fcdaef861d783d0ef91ad1919",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3
            ],
            "targets":[
                0,
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"a",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypessmall.int_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypessmall",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"b",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypessmall.tinyint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypessmall",
                "tableCreateTime":1687531613
            }
        }
    ]
}
====
# Create view with complex select statement (IMPALA-4219)
create view test_view_lineage (a1, a2, a3, a4, a5, a6, a7) as
  select x.smallint_col, x.id, x.tinyint_col, c.id, x.int_col, x.float_col, c.string_col
  from functional.alltypessmall c
  join (
     select a.smallint_col smallint_col, a.tinyint_col tinyint_col, a.day day,
           a.int_col int_col, a.month month, b.float_col float_col, b.id id
     from ( select * from functional.alltypesagg a where month=1 ) a
     join functional.alltypessmall b on (a.smallint_col = b.id)
   ) x on (x.tinyint_col = c.id)
  where x.day=1
  and x.int_col > 899
  and x.float_col > 4.5
  and c.string_col < '7'
  and x.int_col + x.float_col + cast(c.string_col as float) < 1000
---- LINEAGE
{
    "queryText":"create view test_view_lineage (a1, a2, a3, a4, a5, a6, a7) as\n  select x.smallint_col, x.id, x.tinyint_col, c.id, x.int_col, x.float_col, c.string_col\n  from functional.alltypessmall c\n  join (\n     select a.smallint_col smallint_col, a.tinyint_col tinyint_col, a.day day,\n           a.int_col int_col, a.month month, b.float_col float_col, b.id id\n     from ( select * from functional.alltypesagg a where month=1 ) a\n     join functional.alltypessmall b on (a.smallint_col = b.id)\n   ) x on (x.tinyint_col = c.id)\n  where x.day=1\n  and x.int_col > 899\n  and x.float_col > 4.5\n  and c.string_col < '7'\n  and x.int_col + x.float_col + cast(c.string_col as float) < 1000",
    "queryId":"0:0",
    "hash":"687637d408bf427f7851f9dfafb4d637",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                8
            ],
            "targets":[
                7
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                10
            ],
            "targets":[
                9
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                12
            ],
            "targets":[
                11
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                3,
                5,
                8,
                10,
                12,
                13,
                14
            ],
            "targets":[
                0,
                2,
                4,
                6,
                7,
                9,
                11
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"a1",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"a2",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"a3",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"a4",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"a5",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"a6",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"a7",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.day",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypesagg.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypesagg",
                "tableCreateTime":1687531275
            }
        }
    ]
}
====
# Create view with select statement containing an analytic function (IMPALA-4219)
create view test_view_lineage as
  select * from (
    select sum(a.tinyint_col) over (partition by a.smallint_col order by a.id),
      count(b.string_col), b.timestamp_col
    from functional.alltypes a join functional.alltypessmall b on (a.id = b.id)
    where a.year = 2010 and b.float_col > 0
    group by a.tinyint_col, a.smallint_col, a.id, b.string_col, b.timestamp_col, b.bigint_col
    having count(a.int_col) > 10
    order by b.bigint_col limit 10) t
---- LINEAGE
{
    "queryText":"create view test_view_lineage as\n  select * from (\n    select sum(a.tinyint_col) over (partition by a.smallint_col order by a.id),\n      count(b.string_col), b.timestamp_col\n    from functional.alltypes a join functional.alltypessmall b on (a.id = b.id)\n    where a.year = 2010 and b.float_col > 0\n    group by a.tinyint_col, a.smallint_col, a.id, b.string_col, b.timestamp_col, b.bigint_col\n    having count(a.int_col) > 10\n    order by b.bigint_col limit 10) t",
    "queryId":"0:0",
    "hash":"663b053e02a33d9bbd58ddc23ccbc101",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                2,
                3
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                2,
                3,
                5,
                7,
                8,
                9,
                10,
                11,
                12
            ],
            "targets":[
                0,
                4,
                6
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"_c0",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"_c1",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"timestamp_col",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.timestamp_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypessmall.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypessmall",
                "tableCreateTime":1687531269
            }
        }
    ]
}
====
# Alter view statement (IMPALA-4219)
alter view functional.alltypes_view as select id from functional.alltypestiny
---- LINEAGE
{
    "queryText":"alter view functional.alltypes_view as select id from functional.alltypestiny",
    "queryId":"0:0",
    "hash":"f12ecfd6e5357c92cbd14f52b2637e1a",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"view",
                "tableName":"functional.alltypes_view",
                "tableCreateTime":1687531280
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        }
    ]
}
====
# Test references to struct fields.
select * from (
  select int_struct_col.f1 + int_struct_col.f2 x from functional.allcomplextypes
  where year = 2000
  order by nested_struct_col.f2.f12.f21 limit 10
  union all
  select sum(f1) y from
    (select complex_struct_col.f1 f1 from functional.allcomplextypes
     group by 1) v1) v2
---- LINEAGE
{
    "queryText":"select * from (\n  select int_struct_col.f1 + int_struct_col.f2 x from functional.allcomplextypes\n  where year = 2000\n  order by nested_struct_col.f2.f12.f21 limit 10\n  union all\n  select sum(f1) y from\n    (select complex_struct_col.f1 f1 from functional.allcomplextypes\n     group by 1) v1) v2",
    "queryId":"0:0",
    "hash":"c32c80f6a02e5f11b920d658daa4a5c3",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1,
                2,
                3
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                4,
                5
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"x"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.complex_struct_col.f1",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_struct_col.f1",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_struct_col.f2",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.nested_struct_col.f2.f12.f21",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        }
    ]
}
====
# Test absolute collection table refs. Ensure that the vertex ids of sources are
# always an absolute explicit path.
select * from functional.allcomplextypes.int_array_col a inner join
  functional.allcomplextypes.struct_map_col m on (a.item = m.f1)
---- LINEAGE
{
    "queryText":"select * from functional.allcomplextypes.int_array_col a inner join\n  functional.allcomplextypes.struct_map_col m on (a.item = m.f1)",
    "queryId":"0:0",
    "hash":"f0e1c9c0c94732cfb0e44792a1339d3e",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                5
            ],
            "targets":[
                0,
                2,
                4,
                6
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"item"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_array_col.item",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"key"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.key",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"f1"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.value.f1",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"f2"
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.value.f2",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        }
    ]
}
====
# Test relative collection table refs. Ensure that the vertex ids of sources are
# always an absolute explicit path.
select * from functional.allcomplextypes t, t.int_array_col a, t.struct_map_col m
  where a.item = m.f1
---- LINEAGE
{
    "queryText":"select * from functional.allcomplextypes t, t.int_array_col a, t.struct_map_col m\n  where a.item = m.f1",
    "queryId":"0:0",
    "hash":"58bf06d90d336cd80b24a2ea6404aa32",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                13
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7,
                11,
                14,
                15
            ],
            "targets":[
                0,
                2,
                4,
                6,
                8,
                10,
                12
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"year"
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.year",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"month"
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.month",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"item"
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_array_col.item",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"key"
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.key",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"f1"
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.value.f1",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"f2"
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.value.f2",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_array_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        }
    ]
}
====
# Test relative collection table refs in inline views.
select a + b as ab, c, d, e from functional.allcomplextypes t,
  (select sum(item) a from t.int_array_col
   where item < 10) v1,
  (select count(f1) b from t.struct_map_col
   group by key) v2,
  (select avg(value) over(partition by key) c from t.map_map_col.value) v3,
  (select item d from t.int_array_col
   union all
   select value from t.int_map_col) v4,
  (select f21 e from t.complex_nested_struct_col.f2.f12 order by key limit 10) v5
---- LINEAGE
{
    "queryText":"select a + b as ab, c, d, e from functional.allcomplextypes t,\n  (select sum(item) a from t.int_array_col\n   where item < 10) v1,\n  (select count(f1) b from t.struct_map_col\n   group by key) v2,\n  (select avg(value) over(partition by key) c from t.map_map_col.value) v3,\n  (select item d from t.int_array_col\n   union all\n   select value from t.int_map_col) v4,\n  (select f21 e from t.complex_nested_struct_col.f2.f12 order by key limit 10) v5",
    "queryId":"0:0",
    "hash":"17f8a4d5d7a82a254e377d2dd9f3ca66",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1,
                2
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                4
            ],
            "targets":[
                3
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                3
            ],
            "edgeType":"PREDICATE"
        },
        {
            "sources":[
                1,
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                10,
                11
            ],
            "targets":[
                0,
                3,
                6,
                8
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"ab"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_array_col.item",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.value.f1",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"c"
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.map_map_col.value.value",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.map_map_col.value.key",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"d"
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.int_map_col.value",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"e"
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.complex_nested_struct_col.f2.item.f12.value.f21",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.complex_nested_struct_col.f2.item.f12.key",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional.allcomplextypes.struct_map_col.key",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.allcomplextypes",
                "tableCreateTime":1687531278
            }
        }
    ]
}
====
# IMPALA-4206: Test creating a view whose definition has a subquery and a view reference.
create view test_view_lineage as
select id from functional.alltypes_view v
where not exists (select 1 from functional.alltypes a where v.id = a.id)
---- LINEAGE
{
    "queryText":"create view test_view_lineage as\nselect id from functional.alltypes_view v\nwhere not exists (select 1 from functional.alltypes a where v.id = a.id)",
    "queryId":"0:0",
    "hash":"41a074680a8eedce05db55fde68669e0",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"view",
                "tableName":"default.test_view_lineage",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Select query that accesses a Kudu table
select count(*) from functional_kudu.alltypes k join functional.alltypes h on k.id = h.id
where k.int_col < 10
---- LINEAGE
{
    "queryText":"select count(*) from functional_kudu.alltypes k join functional.alltypes h on k.id = h.id\nwhere k.int_col < 10",
    "queryId":"0:0",
    "hash":"0528557b137722769f5df029d4816c7a",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1,
                2,
                3
            ],
            "targets":[
                0
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"count(*)"
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypes.id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypes",
                "tableCreateTime":1687531210
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypes.int_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypes",
                "tableCreateTime":1687531210
            }
        }
    ]
}
====
# Insert into a Kudu table
insert into functional_kudu.testtbl select id, string_col as name, int_col as zip from
functional.alltypes a where a.id < 100
---- LINEAGE
{
    "queryText":"insert into functional_kudu.testtbl select id, string_col as name, int_col as zip from\nfunctional.alltypes a where a.id < 100",
    "queryId":"0:0",
    "hash":"dd40a5127a7a1abe4708ac58811680ae",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"name",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"zip",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Insert into a Kudu table with a column list specified
insert into functional_kudu.testtbl (name, id) select string_col as name, id from
functional.alltypes where id < 10
---- LINEAGE
{
    "queryText":"insert into functional_kudu.testtbl (name, id) select string_col as name, id from\nfunctional.alltypes where id < 10",
    "queryId":"0:0",
    "hash":"111bc2413ac3bc54cdca8c0f0fc3cb8c",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                0,
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"name",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# Upsert into a Kudu table with a column list specified
upsert into functional_kudu.testtbl (name, id) select string_col as name, id from
functional.alltypes where id < 10
---- LINEAGE
{
    "queryText":"upsert into functional_kudu.testtbl (name, id) select string_col as name, id from\nfunctional.alltypes where id < 10",
    "queryId":"0:0",
    "hash":"848add05dd236efd79bffd369a0bdb69",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                0,
                2
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"name",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypes.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypes",
                "tableCreateTime":1687531267
            }
        }
    ]
}
====
# CTAS a Kudu table
create table kudu_ctas primary key (id) partition by hash (id) partitions 3
stored as kudu as select id, bool_col, tinyint_col, smallint_col, int_col,
bigint_col, float_col, double_col, date_string_col, string_col
from functional.alltypestiny
---- LINEAGE
{
    "queryText":"create table kudu_ctas primary key (id) partition by hash (id) partitions 3\nstored as kudu as select id, bool_col, tinyint_col, smallint_col, int_col,\nbigint_col, float_col, double_col, date_string_col, string_col\nfrom functional.alltypestiny",
    "queryId":"0:0",
    "hash":"1baf83a160e93356a7b12a393f147355",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                13
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                15
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                17
            ],
            "targets":[
                16
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                19
            ],
            "targets":[
                18
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.id",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.bool_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"tinyint_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.tinyint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"smallint_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.smallint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.int_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.bigint_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.float_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.double_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":17,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.date_string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        },
        {
            "id":18,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"default.kudu_ctas",
                "tableCreateTime":-1
            }
        },
        {
            "id":19,
            "vertexType":"COLUMN",
            "vertexId":"functional.alltypestiny.string_col",
            "metadata":{
                "tableType":"hive",
                "tableName":"functional.alltypestiny",
                "tableCreateTime":1687531270
            }
        }
    ]
}
====
# CTAS an Iceberg table from an HBase Table
create table ice_ctas_from_hbase partitioned by spec (bucket(7,id))
stored as iceberg as select id, bool_col, int_col,
bigint_col, float_col, double_col, date_string_col, string_col
from functional_hbase.alltypestiny
---- LINEAGE
{
    "queryText":"create table ice_ctas_from_hbase partitioned by spec (bucket(7,id))\nstored as iceberg as select id, bool_col, int_col,\nbigint_col, float_col, double_col, date_string_col, string_col\nfrom functional_hbase.alltypestiny",
    "queryId":"0:0",
    "hash":"fc2031078e9801a8965cd81a415955d0",
    "user":"dummy_user",
    "timestamp":1687551746,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                13
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                15
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.id",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.bool_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.int_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.bigint_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.float_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.double_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.date_string_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_hbase",
                "tableCreateTime":-1
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"functional_hbase.alltypestiny.string_col",
            "metadata":{
                "tableType":"hbase",
                "tableName":"functional_hbase.alltypestiny",
                "tableCreateTime":1687531613
            }
        }
    ]
}
====
# CTAS an Iceberg table from an Kudu Table
create table ice_ctas_from_kudu partitioned by spec (truncate(100, id))
stored as iceberg as select id, bool_col, int_col,
bigint_col, float_col, double_col, date_string_col, string_col
from functional_kudu.alltypestiny
---- LINEAGE
{
    "queryText":"create table ice_ctas_from_kudu partitioned by spec (truncate(100, id))\nstored as iceberg as select id, bool_col, int_col,\nbigint_col, float_col, double_col, date_string_col, string_col\nfrom functional_kudu.alltypestiny",
    "queryId":"0:0",
    "hash":"5f8edff98099449082049dda676428b0",
    "user":"dummy_user",
    "timestamp":1687551747,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                13
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                15
            ],
            "targets":[
                14
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"bool_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.bool_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"int_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.int_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"bigint_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.bigint_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"float_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.float_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"double_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.double_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"date_string_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.date_string_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"string_col",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"default.ice_ctas_from_kudu",
                "tableCreateTime":-1
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.string_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        }
    ]
}
====
# INSERT INTO Iceberg table FROM Kudu table
INSERT INTO functional_parquet.iceberg_alltypes_part SELECT id, bool_col, int_col,
bigint_col, float_col, double_col, 3.14, cast(date_string_col as date format 'MM/DD/YYYY'),
string_col from functional_kudu.alltypestiny
---- LINEAGE
{
    "queryText":"INSERT INTO functional_parquet.iceberg_alltypes_part SELECT id, bool_col, int_col,\nbigint_col, float_col, double_col, 3.14, cast(date_string_col as date format 'MM/DD/YYYY'),\nstring_col from functional_kudu.alltypestiny",
    "queryId":"0:0",
    "hash":"58cca98fbd61b04a38cce3c6d33db56d",
    "user":"dummy_user",
    "timestamp":1687553401,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                5
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                7
            ],
            "targets":[
                6
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                9
            ],
            "targets":[
                8
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                11
            ],
            "targets":[
                10
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
            ],
            "targets":[
                12
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                14
            ],
            "targets":[
                13
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                16
            ],
            "targets":[
                15
            ],
            "edgeType":"PROJECTION"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"i",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"p_bool",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.bool_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"p_int",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":5,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.int_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":6,
            "vertexType":"COLUMN",
            "vertexId":"p_bigint",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":7,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.bigint_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":8,
            "vertexType":"COLUMN",
            "vertexId":"p_float",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":9,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.float_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":10,
            "vertexType":"COLUMN",
            "vertexId":"p_double",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":11,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.double_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":12,
            "vertexType":"COLUMN",
            "vertexId":"p_decimal",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":13,
            "vertexType":"COLUMN",
            "vertexId":"p_date",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":14,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.date_string_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        },
        {
            "id":15,
            "vertexType":"COLUMN",
            "vertexId":"p_string",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_alltypes_part",
                "tableCreateTime":1687531277
            }
        },
        {
            "id":16,
            "vertexType":"COLUMN",
            "vertexId":"functional_kudu.alltypestiny.string_col",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.alltypestiny",
                "tableCreateTime":1687531219
            }
        }
    ]
}
====
# INSERT INTO Kudu table FROM Iceberg table
insert into functional_kudu.testtbl select id, user as name, cast(id*2 as INT) as zip
from functional_parquet.iceberg_partitioned a where a.id < 100
---- LINEAGE
{
    "queryText":"insert into functional_kudu.testtbl select id, user as name, cast(id*2 as INT) as zip\nfrom functional_parquet.iceberg_partitioned a where a.id < 100",
    "queryId":"0:0",
    "hash":"e1c26e3c7ec88ea6ffe339402631655b",
    "user":"dummy_user",
    "timestamp":1687553401,
    "edges":[
        {
            "sources":[
                1
            ],
            "targets":[
                0
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                3
            ],
            "targets":[
                2
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                4
            ],
            "edgeType":"PROJECTION"
        },
        {
            "sources":[
                1
            ],
            "targets":[
                0,
                2,
                4
            ],
            "edgeType":"PREDICATE"
        }
    ],
    "vertices":[
        {
            "id":0,
            "vertexType":"COLUMN",
            "vertexId":"id",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":1,
            "vertexType":"COLUMN",
            "vertexId":"functional_parquet.iceberg_partitioned.id",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_partitioned",
                "tableCreateTime":1687531274
            }
        },
        {
            "id":2,
            "vertexType":"COLUMN",
            "vertexId":"name",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        },
        {
            "id":3,
            "vertexType":"COLUMN",
            "vertexId":"functional_parquet.iceberg_partitioned.user",
            "metadata":{
                "tableType":"iceberg",
                "tableName":"functional_parquet.iceberg_partitioned",
                "tableCreateTime":1687531274
            }
        },
        {
            "id":4,
            "vertexType":"COLUMN",
            "vertexId":"zip",
            "metadata":{
                "tableType":"kudu",
                "tableName":"functional_kudu.testtbl",
                "tableCreateTime":1687531236
            }
        }
    ]
}
====
